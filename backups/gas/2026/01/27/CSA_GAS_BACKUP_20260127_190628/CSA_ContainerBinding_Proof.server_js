/**
 * ============================================================
 * File: CSA_ContainerBinding_Proof.gs
 * Product: CSA_v1
 * Product Version: v1.1.0
 * Purpose: DEFINITIVE CONTAINER-BINDING PROOF
 * Phase: Diagnostic / Proof
 * Created: 2026-01-21 MST
 * Authors:
 *   Tim Caldwell
 *   ChatGPT (DEV028)
 *
 * ------------------------------------------------------------
 * WHAT THIS SCRIPT PROVES
 * ------------------------------------------------------------
 * This script determines, with 100% certainty:
 * - Whether the current Apps Script project is container-bound
 * - Whether it is bound to a SPREADSHEET specifically
 * - Whether SpreadsheetApp APIs are callable in-context
 *
 * No guesses. No heuristics. No UI calls.
 *
 * ------------------------------------------------------------
 * HOW TO USE
 * ------------------------------------------------------------
 * 1. Save this file
 * 2. Run the function: CSA_ProveContainerBinding_
 * 3. Open View → Logs
 * 4. Read the verdict section at the bottom
 *
 * ============================================================
 */

function CSA_ProveContainerBinding_() {
  Logger.log('===== CSA CONTAINER BINDING PROOF =====');

  // 1) Attempt to access the active spreadsheet
  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();

    if (!ss) {
      Logger.log('❌ RESULT: SpreadsheetApp.getActiveSpreadsheet() returned NULL');
      Logger.log('❌ VERDICT: NOT CONTAINER-BOUND');
      return;
    }

    Logger.log('✅ Active Spreadsheet ID: ' + ss.getId());
    Logger.log('✅ Active Spreadsheet Name: ' + ss.getName());

  } catch (err) {
    Logger.log('❌ EXCEPTION calling SpreadsheetApp.getActiveSpreadsheet()');
    Logger.log('❌ ERROR: ' + err.message);
    Logger.log('❌ VERDICT: NOT CONTAINER-BOUND');
    return;
  }

  // 2) Attempt to access UI (read-only call)
  try {
    const ui = SpreadsheetApp.getUi();
    if (ui) {
      Logger.log('✅ Spreadsheet UI object acquired');
    }
  } catch (err) {
    Logger.log('⚠️ UI access failed (this can be permission-related)');
    Logger.log('⚠️ ERROR: ' + err.message);
  }

  // 3) Script metadata
  try {
    const scriptId = ScriptApp.getScriptId();
    Logger.log('ℹ️ Script ID: ' + scriptId);
  } catch (err) {
    Logger.log('⚠️ Unable to read Script ID: ' + err.message);
  }

  // 4) Final verdict
  Logger.log('--------------------------------------');
  Logger.log('✅ FINAL VERDICT: THIS SCRIPT IS CONTAINER-BOUND');
  Logger.log('✅ BINDING TYPE: GOOGLE SPREADSHEET');
  Logger.log('===== END PROOF =====');
}
